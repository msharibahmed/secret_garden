<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>James Bond's Secret Garden</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŒ¹</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Lora:ital,wght@0,400;1,400&display=swap" rel="stylesheet">
    <style>
        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --phase-transition: 3s ease;
            --text-primary: #f4e8d4;
            --text-secondary: #c4a882;
            --glass-bg: rgba(12, 12, 30, 0.88);
            --glass-border: rgba(255, 200, 140, 0.12);
            --btn-bg: rgba(255, 200, 140, 0.08);
            --btn-hover: rgba(255, 200, 140, 0.16);
            --counter-color: rgba(244, 232, 212, 0.3);
            --ripple-color: rgba(255, 200, 140, 0.3);
            --header-glow: rgba(255, 200, 140, 0.15);
        }

        body[data-phase="dawn"] {
            --text-primary: #f0e0d0;
            --text-secondary: #c89868;
            --glass-bg: rgba(40, 18, 28, 0.84);
            --glass-border: rgba(255, 180, 120, 0.15);
            --btn-bg: rgba(255, 180, 120, 0.1);
            --btn-hover: rgba(255, 180, 120, 0.2);
            --counter-color: rgba(240, 224, 208, 0.35);
            --ripple-color: rgba(255, 180, 120, 0.35);
            --header-glow: rgba(255, 160, 100, 0.25);
        }

        body[data-phase="day"] {
            --text-primary: #2a3a22;
            --text-secondary: #5a6a4a;
            --glass-bg: rgba(255, 255, 255, 0.8);
            --glass-border: rgba(60, 110, 60, 0.14);
            --btn-bg: rgba(60, 130, 60, 0.1);
            --btn-hover: rgba(60, 130, 60, 0.2);
            --counter-color: rgba(42, 58, 34, 0.3);
            --ripple-color: rgba(100, 180, 100, 0.3);
            --header-glow: rgba(60, 110, 60, 0.15);
        }

        body[data-phase="dusk"] {
            --text-primary: #f4e4d0;
            --text-secondary: #c8906a;
            --glass-bg: rgba(30, 14, 24, 0.86);
            --glass-border: rgba(255, 150, 90, 0.14);
            --btn-bg: rgba(255, 150, 90, 0.1);
            --btn-hover: rgba(255, 150, 90, 0.2);
            --counter-color: rgba(244, 228, 208, 0.3);
            --ripple-color: rgba(255, 160, 100, 0.3);
            --header-glow: rgba(255, 140, 80, 0.2);
        }

        body {
            min-width: 100vw;
            min-height: 100vh;
            overflow: auto;
            font-family: 'Cormorant Garamond', 'Georgia', serif;
            cursor: crosshair;
            user-select: none;
            -webkit-user-select: none;
            background: #060e1a;
        }

        /* â”€â”€ Sky Layers â”€â”€ */
        #sky {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
        }

        .sky-layer {
            position: absolute;
            inset: 0;
            opacity: 0;
            transition: opacity var(--phase-transition);
        }

        .sky-night { background: radial-gradient(ellipse at 50% 15%, #0f1f3a 0%, #060e1a 50%, #0d2618 100%); }
        .sky-dawn  { background: linear-gradient(to bottom, #1a1040 0%, #582858 22%, #c05838 52%, #e8a858 78%, #f0d8a0 100%); }
        .sky-day   { background: linear-gradient(to bottom, #5898d0 0%, #80bae4 32%, #a8d4f0 62%, #c8e4f6 100%); }
        .sky-dusk  { background: linear-gradient(to bottom, #0e1838 0%, #3a2058 22%, #a83838 48%, #d87838 72%, #e8b060 100%); }

        body[data-phase="night"] .sky-night { opacity: 1; }
        body[data-phase="dawn"]  .sky-dawn  { opacity: 1; }
        body[data-phase="day"]   .sky-day   { opacity: 1; }
        body[data-phase="dusk"]  .sky-dusk  { opacity: 1; }

        /* â”€â”€ Header â”€â”€ */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            text-align: center;
            z-index: 10;
            pointer-events: none;
            padding: 28px 20px 20px;
        }

        .header h1 {
            color: var(--text-primary);
            font-size: 1.75rem;
            font-weight: 300;
            letter-spacing: 5px;
            text-transform: uppercase;
            text-shadow: 0 0 40px var(--header-glow);
            opacity: 0;
            animation: headerIn 2s ease-out 0.5s forwards;
            transition: color var(--phase-transition), text-shadow var(--phase-transition);
        }

        .header p {
            color: var(--text-secondary);
            font-family: 'Lora', serif;
            font-size: 0.82rem;
            font-style: italic;
            margin-top: 10px;
            opacity: 0;
            animation: headerIn 2s ease-out 1.2s forwards;
            transition: color var(--phase-transition);
        }

        @keyframes headerIn {
            0% { opacity: 0; transform: translateY(-10px); }
            100% { opacity: 0.75; transform: translateY(0); }
        }

        /* â”€â”€ Garden Canvas â”€â”€ */
        #garden {
            width: 100%;
            min-height: 100vh;
            position: relative;
            z-index: 3;
        }

        /* â”€â”€ Ground Layers â”€â”€ */
        #groundLayers {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 130px;
            z-index: 2;
            pointer-events: none;
        }

        .ground-layer {
            position: absolute;
            inset: 0;
            opacity: 0;
            transition: opacity var(--phase-transition);
        }

        .ground-night { background: linear-gradient(to top, #0a1a0d 0%, #162e1a 35%, rgba(13, 38, 24, 0.4) 70%, transparent 100%); }
        .ground-dawn  { background: linear-gradient(to top, #1a2a0a 0%, #2e4a18 35%, rgba(35, 55, 20, 0.4) 70%, transparent 100%); }
        .ground-day   { background: linear-gradient(to top, #28681e 0%, #4a9a36 35%, rgba(55, 120, 40, 0.35) 70%, transparent 100%); }
        .ground-dusk  { background: linear-gradient(to top, #101a08 0%, #1e3810 35%, rgba(22, 42, 14, 0.4) 70%, transparent 100%); }

        body[data-phase="night"] .ground-night { opacity: 1; }
        body[data-phase="dawn"]  .ground-dawn  { opacity: 1; }
        body[data-phase="day"]   .ground-day   { opacity: 1; }
        body[data-phase="dusk"]  .ground-dusk  { opacity: 1; }

        /* â”€â”€ Stars â”€â”€ */
        #starsContainer {
            position: fixed;
            inset: 0;
            z-index: 1;
            pointer-events: none;
            transition: opacity var(--phase-transition);
        }

        body[data-phase="night"] #starsContainer { opacity: 1; }
        body[data-phase="dawn"]  #starsContainer { opacity: 0.3; }
        body[data-phase="day"]   #starsContainer { opacity: 0; }
        body[data-phase="dusk"]  #starsContainer { opacity: 0.4; }

        .star { position: absolute; border-radius: 50%; }
        .star--small {
            background: rgba(200, 210, 255, 0.6);
            animation: twinkleSmall var(--dur) ease-in-out infinite;
        }
        .star--bright {
            background: rgba(255, 245, 230, 0.9);
            box-shadow: 0 0 3px rgba(255, 245, 230, 0.4);
            animation: twinkleBright var(--dur) ease-in-out infinite;
        }

        @keyframes twinkleSmall {
            0%, 100% { opacity: 0.1; }
            50% { opacity: 0.55; }
        }
        @keyframes twinkleBright {
            0%, 100% { opacity: 0.15; transform: scale(1); }
            50% { opacity: 0.85; transform: scale(1.3); }
        }

        /* â”€â”€ Clouds â”€â”€ */
        #cloudsContainer {
            position: fixed;
            inset: 0;
            z-index: 1;
            pointer-events: none;
            overflow: hidden;
            transition: opacity var(--phase-transition);
            opacity: 0;
        }

        body[data-phase="night"] #cloudsContainer { opacity: 0; }
        body[data-phase="dawn"]  #cloudsContainer { opacity: 0.5; }
        body[data-phase="day"]   #cloudsContainer { opacity: 1; }
        body[data-phase="dusk"]  #cloudsContainer { opacity: 0.55; }

        .cloud {
            position: absolute;
            border-radius: 40px;
            pointer-events: none;
            animation: driftCloud var(--cloud-dur) linear infinite;
            animation-delay: var(--cloud-delay);
        }
        .cloud::before, .cloud::after {
            content: '';
            position: absolute;
            background: inherit;
            border-radius: 50%;
        }
        .cloud::before { width: 55%; height: 110%; top: -50%; left: 18%; }
        .cloud::after  { width: 40%; height: 85%;  top: -35%; right: 18%; }

        @keyframes driftCloud {
            0%   { transform: translateX(-200px); }
            100% { transform: translateX(calc(100vw + 200px)); }
        }

        body[data-phase="day"]  .cloud { background: rgba(255, 255, 255, 0.7); }
        body[data-phase="dawn"] .cloud { background: rgba(240, 180, 160, 0.5); }
        body[data-phase="dusk"] .cloud { background: rgba(220, 150, 120, 0.45); }

        /* â”€â”€ Fireflies â”€â”€ */
        #firefliesContainer {
            position: fixed;
            inset: 0;
            z-index: 1;
            pointer-events: none;
            transition: opacity var(--phase-transition);
            opacity: 0;
        }

        body[data-phase="night"] #firefliesContainer { opacity: 1; }
        body[data-phase="dusk"]  #firefliesContainer { opacity: 0.6; }

        .firefly {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: #ffe8a0;
            box-shadow: 0 0 6px 2px rgba(255, 220, 100, 0.5), 0 0 14px 4px rgba(255, 200, 60, 0.2);
            animation: fireflyDrift var(--ff-dur) ease-in-out infinite, fireflyGlow var(--ff-glow-dur) ease-in-out infinite;
            animation-delay: var(--ff-delay);
        }

        @keyframes fireflyDrift {
            0%   { transform: translate(0, 0); }
            25%  { transform: translate(var(--ff-dx1), var(--ff-dy1)); }
            50%  { transform: translate(var(--ff-dx2), var(--ff-dy2)); }
            75%  { transform: translate(var(--ff-dx3), var(--ff-dy3)); }
            100% { transform: translate(0, 0); }
        }

        @keyframes fireflyGlow {
            0%, 100% { opacity: 0.15; box-shadow: 0 0 4px 1px rgba(255, 220, 100, 0.3); }
            50%      { opacity: 0.9;  box-shadow: 0 0 8px 3px rgba(255, 220, 100, 0.6), 0 0 20px 6px rgba(255, 200, 60, 0.2); }
        }

        /* â”€â”€ Butterfly Cursor â”€â”€ */
        #butterfly {
            position: fixed;
            z-index: 12;
            pointer-events: none;
            font-size: 1.2rem;
            transition: opacity var(--phase-transition);
            opacity: 0;
            will-change: transform;
        }

        body[data-phase="day"]  #butterfly { opacity: 1; }
        body[data-phase="dawn"] #butterfly { opacity: 0.7; }

        /* â”€â”€ Floating Petals â”€â”€ */
        #petalsContainer {
            position: fixed;
            inset: 0;
            z-index: 1;
            pointer-events: none;
            transition: opacity var(--phase-transition);
        }
        body[data-phase="day"] #petalsContainer { opacity: 0.6; }

        .petal {
            position: absolute;
            opacity: 0;
            will-change: transform, opacity;
            animation: floatDown var(--fall-dur) linear infinite;
            animation-delay: var(--delay);
        }

        @keyframes floatDown {
            0%   { transform: translate(0, -30px) rotate(0deg) scale(0.8); opacity: 0; }
            6%   { opacity: 0.22; }
            50%  { transform: translate(var(--drift-mid), 50vh) rotate(360deg) scale(1); opacity: 0.18; }
            92%  { opacity: 0.15; }
            100% { transform: translate(var(--drift-end), calc(100vh + 30px)) rotate(720deg) scale(0.6); opacity: 0; }
        }

        /* â”€â”€ Flower Container â”€â”€ */
        .flower-container {
            position: absolute;
            transform: translate(-50%, -50%);
            z-index: 5;
            will-change: filter;
            transition: filter 0.35s ease;
        }
        .flower-container:hover { filter: brightness(1.25); }

        .flower-el {
            display: block;
            text-align: center;
            line-height: 1;
            will-change: transform, opacity;
        }

        .stage-seed {
            font-size: 1.3rem;
            animation: seedDrop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }
        @keyframes seedDrop {
            0%   { transform: scale(0) rotate(120deg) translateY(-20px); opacity: 0; }
            50%  { transform: scale(1.2) rotate(-8deg) translateY(2px); opacity: 1; }
            70%  { transform: scale(0.9) rotate(3deg) translateY(-1px); }
            100% { transform: scale(1) rotate(0deg) translateY(0); opacity: 1; }
        }

        .stage-sprout {
            font-size: 1.5rem;
            animation: sproutGrow 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }
        @keyframes sproutGrow {
            0%   { transform: scale(0.5) translateY(8px); opacity: 0.6; }
            60%  { transform: scale(1.15) translateY(-2px); }
            100% { transform: scale(1) translateY(0); opacity: 1; }
        }

        .stage-bloom {
            font-size: 2.5rem;
            animation: bloomOpen 1.1s cubic-bezier(0.22, 1, 0.36, 1) forwards;
            filter: drop-shadow(0 0 12px var(--glow));
        }
        @keyframes bloomOpen {
            0%   { transform: scale(0.2) rotate(-60deg); opacity: 0; filter: drop-shadow(0 0 0 var(--glow)); }
            40%  { transform: scale(1.15) rotate(8deg); opacity: 1; }
            65%  { transform: scale(0.95) rotate(-3deg); }
            80%  { transform: scale(1.05) rotate(1deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; filter: drop-shadow(0 0 12px var(--glow)); }
        }

        .stage-bloom.sway {
            animation: gentleSway 4s ease-in-out infinite;
            transform-origin: bottom center;
        }
        @keyframes gentleSway {
            0%, 100% { transform: rotate(-1.5deg) translateX(-0.5px); }
            25%  { transform: rotate(1deg) translateX(0.5px); }
            50%  { transform: rotate(-1deg) translateX(-0.3px); }
            75%  { transform: rotate(1.5deg) translateX(0.3px); }
        }

        /* â”€â”€ Rare Flower Glow â”€â”€ */
        .stage-bloom.rare-bloom {
            animation: rareBloomOpen 1.4s cubic-bezier(0.22, 1, 0.36, 1) forwards;
            filter: drop-shadow(0 0 18px var(--glow)) drop-shadow(0 0 40px var(--glow));
        }
        @keyframes rareBloomOpen {
            0%   { transform: scale(0.1) rotate(-90deg); opacity: 0; }
            30%  { transform: scale(1.3) rotate(10deg); opacity: 1; }
            50%  { transform: scale(0.9) rotate(-5deg); }
            70%  { transform: scale(1.15) rotate(3deg); }
            85%  { transform: scale(0.97) rotate(-1deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        .stage-bloom.rare-bloom.sway {
            animation: rareSway 5s ease-in-out infinite;
            transform-origin: bottom center;
        }
        @keyframes rareSway {
            0%, 100% { transform: rotate(-2deg); filter: drop-shadow(0 0 18px var(--glow)) drop-shadow(0 0 40px var(--glow)); }
            50%      { transform: rotate(2deg);  filter: drop-shadow(0 0 24px var(--glow)) drop-shadow(0 0 50px var(--glow)); }
        }

        /* â”€â”€ Wilted State â”€â”€ */
        .stage-wilted {
            font-size: 2.2rem;
            filter: grayscale(0.7) brightness(0.6);
            transform: rotate(8deg);
            animation: wiltDroop 1.2s ease-in forwards;
        }
        @keyframes wiltDroop {
            0%   { filter: grayscale(0) brightness(1); transform: rotate(0deg) scale(1); }
            60%  { filter: grayscale(0.5) brightness(0.7); transform: rotate(6deg) scale(0.95); }
            100% { filter: grayscale(0.7) brightness(0.6); transform: rotate(8deg) scale(0.9); }
        }
        .stage-wilted.from-save {
            animation: none;
            transform: rotate(8deg) scale(0.9);
        }

        .flower-container.wilted {
            cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='26' viewBox='0 0 20 26'%3E%3Cpath d='M10 3C10 3 3 11 3 16C3 20 6 23 10 23C14 23 17 20 17 16C17 11 10 3 10 3Z' fill='%2368b8f8' stroke='%23fff' stroke-width='1.2'/%3E%3C/svg%3E") 10 13, pointer;
        }
        .flower-container.wilted:hover { filter: brightness(1.1) saturate(1.2); }

        /* Water Splash */
        .water-drop {
            position: absolute;
            pointer-events: none;
            font-size: 0.6rem;
            color: #68b8f8;
            animation: waterFall 0.9s ease-in forwards;
        }
        @keyframes waterFall {
            0%   { opacity: 1; transform: translate(var(--wx), 0) scale(1); }
            100% { opacity: 0; transform: translate(var(--wx), 30px) scale(0.5); }
        }

        .water-ring {
            position: absolute;
            top: 50%; left: 50%;
            width: 6px; height: 6px;
            margin: -3px 0 0 -3px;
            border-radius: 50%;
            border: 1.5px solid rgba(104, 184, 248, 0.5);
            pointer-events: none;
            animation: waterRingExpand 0.8s ease-out forwards;
        }
        @keyframes waterRingExpand {
            0%   { transform: scale(1); opacity: 0.6; }
            100% { transform: scale(6); opacity: 0; }
        }

        /* â”€â”€ Sparkles â”€â”€ */
        .sparkle-ring { position: absolute; top: 50%; left: 50%; width: 0; height: 0; pointer-events: none; }
        .sparkle {
            position: absolute;
            pointer-events: none;
            font-size: 0.65rem;
            will-change: transform, opacity;
            animation: sparkleOut 1.1s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        }
        @keyframes sparkleOut {
            0%   { opacity: 1; transform: translate(0, 0) scale(1.2); }
            60%  { opacity: 0.8; }
            100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0); }
        }

        .bloom-ring {
            position: absolute;
            top: 50%; left: 50%;
            width: 8px; height: 8px;
            margin: -4px 0 0 -4px;
            border-radius: 50%;
            border: 1.5px solid var(--ring-color);
            pointer-events: none;
            animation: ringExpand 1s ease-out forwards;
        }
        @keyframes ringExpand {
            0%   { transform: scale(1); opacity: 0.7; }
            100% { transform: scale(8); opacity: 0; }
        }

        /* â”€â”€ Tooltip â”€â”€ */
        .tooltip {
            position: absolute;
            bottom: calc(100% + 14px);
            left: 50%;
            transform: translateX(-50%) translateY(4px);
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            color: var(--text-primary);
            padding: 9px 16px;
            border-radius: 12px;
            font-family: 'Lora', serif;
            font-size: 0.76rem;
            white-space: nowrap;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease, transform 0.3s ease, background var(--phase-transition), color var(--phase-transition), border-color var(--phase-transition);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%; left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: var(--glass-bg);
            transition: border-top-color var(--phase-transition);
        }
        .flower-container:hover .tooltip {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* â”€â”€ Milestone Toast â”€â”€ */
        .milestone-toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 28px 40px;
            color: var(--text-primary);
            font-family: 'Lora', serif;
            font-size: 1rem;
            text-align: center;
            z-index: 90;
            opacity: 0;
            pointer-events: none;
            animation: toastIn 3.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
            box-shadow: 0 16px 60px rgba(0, 0, 0, 0.3);
            max-width: 340px;
            line-height: 1.7;
        }
        @keyframes toastIn {
            0%   { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            15%  { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            75%  { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.95) translateY(-10px); }
        }

        /* â”€â”€ Counter â”€â”€ */
        .counter {
            position: fixed;
            bottom: 22px;
            right: 28px;
            color: var(--counter-color);
            font-family: 'Lora', serif;
            font-size: 0.75rem;
            letter-spacing: 0.5px;
            z-index: 10;
            pointer-events: none;
            transition: color var(--phase-transition);
        }

        /* â”€â”€ Click Ripple â”€â”€ */
        .click-ripple {
            position: absolute;
            width: 6px; height: 6px;
            border-radius: 50%;
            background: var(--ripple-color);
            transform: translate(-50%, -50%);
            pointer-events: none;
            animation: ripple 0.8s ease-out forwards;
            z-index: 4;
        }
        @keyframes ripple {
            0%   { transform: translate(-50%, -50%) scale(1); opacity: 0.5; }
            100% { transform: translate(-50%, -50%) scale(12); opacity: 0; }
        }

        /* â”€â”€ Scrollbar â”€â”€ */
        body::-webkit-scrollbar { width: 6px; height: 6px; }
        body::-webkit-scrollbar-track { background: transparent; }
        body::-webkit-scrollbar-thumb { background: rgba(128, 128, 128, 0.15); border-radius: 3px; }
        body::-webkit-scrollbar-thumb:hover { background: rgba(128, 128, 128, 0.3); }
        body::-webkit-scrollbar-corner { background: transparent; }


        @media (max-width: 480px) {
            .header h1 { font-size: 1.25rem; letter-spacing: 3px; }
            .header p { font-size: 0.75rem; }
            .stage-bloom { font-size: 2rem; }
            .milestone-toast { max-width: 280px; font-size: 0.9rem; padding: 22px 28px; }
        }
    </style>
</head>
<body data-phase="night">

<div id="sky">
    <div class="sky-layer sky-night"></div>
    <div class="sky-layer sky-dawn"></div>
    <div class="sky-layer sky-day"></div>
    <div class="sky-layer sky-dusk"></div>
</div>

<div id="starsContainer"></div>
<div id="cloudsContainer"></div>
<div id="firefliesContainer"></div>
<div id="petalsContainer"></div>
<div id="butterfly"></div>

<div class="header">
    <h1>James Bond's Secret Garden</h1>
    <p>click anywhere to plant a flower</p>
</div>

<div id="groundLayers">
    <div class="ground-layer ground-night"></div>
    <div class="ground-layer ground-dawn"></div>
    <div class="ground-layer ground-day"></div>
    <div class="ground-layer ground-dusk"></div>
</div>

<div id="garden"></div>


<div class="counter" id="counter"></div>

<script>
    const FLOWERS = [
        {
            emoji: '\uD83C\uDF39', name: 'Rose', glow: '#e74c3c',
            range: [5 * 60, 90 * 60]
        },
        {
            emoji: '\uD83C\uDF3B', name: 'Sunflower', glow: '#e8a317',
            range: [10 * 60, 120 * 60]
        },
        {
            emoji: '\uD83C\uDF37', name: 'Tulip', glow: '#d81b60',
            range: [3 * 60, 60 * 60]
        },
        {
            emoji: '\uD83C\uDF3C', name: 'Daisy', glow: '#f9a825',
            range: [2 * 60, 45 * 60]
        },
        {
            emoji: '\uD83C\uDF38', name: 'Cherry Blossom', glow: '#f06292',
            range: [8 * 60, 100 * 60]
        },
        {
            emoji: '\uD83C\uDF3A', name: 'Hibiscus', glow: '#b71c1c',
            range: [15 * 60, 150 * 60]
        },
        {
            emoji: '\uD83E\uDEBB', name: 'Lavender', glow: '#8e44ad',
            range: [20 * 60, 180 * 60]
        },
        {
            emoji: '\uD83D\uDC90', name: 'Bouquet', glow: '#e64a19',
            range: [10 * 60, 120 * 60]
        }
    ];

    const RARE_FLOWER = {
        emoji: '\uD83C\uDF3C', name: 'Golden Dahlia', glow: '#d4aa40', rare: true,
        range: [30 * 60, 180 * 60],
        chance: 0.015
    };

    const WILT_RANGE = [60 * 60, 3 * 60 * 60]; // 1â€“3 hours after bloom

    const MILESTONES = {
        5:   'Five already. This is becoming an actual garden.',
        10:  'Ten flowers. Someone\'s got a green thumb.',
        25:  'Twenty-five. Okay, this is getting impressive.',
        50:  'Fifty flowers. This garden has its own ecosystem now.',
        100: 'A hundred flowers. At this point, this is a botanical garden.',
        200: 'Two hundred. You\'re basically a professional gardener.',
        500: 'Five hundred. This garden has more flowers than most real gardens.'
    };

    function formatTimeLeft(totalSec) {
        const h = Math.floor(totalSec / 3600);
        const m = Math.floor((totalSec % 3600) / 60);
        const s = totalSec % 60;
        if (h > 0 && m > 0) return h + 'h ' + m + 'm';
        if (h > 0) return h + 'h';
        if (m > 0 && s > 0) return m + 'm ' + s + 's';
        if (m > 0) return m + 'm';
        return s + 's';
    }

    const SPARKLE_CHARS = ['\u2726', '\u2727', '\u22C6', '\u02DA', '\u2736'];
    const PETAL_CHARS = ['\uD83C\uDF38', '\u273F', '\u2740', '\u2055'];

    const garden = document.getElementById('garden');
    const counterEl = document.getElementById('counter');
    const butterflyEl = document.getElementById('butterfly');

    // â”€â”€ Storage â”€â”€
    const STORAGE_KEY = 'secret_garden_data';

    function loadGarden() {
        try {
            const raw = localStorage.getItem(STORAGE_KEY);
            if (!raw) return { flowers: [], count: 0 };
            return JSON.parse(raw);
        } catch { return { flowers: [], count: 0 }; }
    }

    function saveGarden(data) {
        try { localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); } catch {}
    }

    let gardenData = loadGarden();
    let flowerCount = gardenData.count || 0;
    let activeTimers = [];

    // â”€â”€ Day/Night Phase â”€â”€
    function getPhase() {
        const h = new Date().getHours();
        if (h >= 5  && h < 7)  return 'dawn';
        if (h >= 7  && h < 18) return 'day';
        if (h >= 18 && h < 20) return 'dusk';
        return 'night';
    }

    function applyPhase() {
        document.body.setAttribute('data-phase', getPhase());
    }

    applyPhase();
    setInterval(applyPhase, 60 * 1000);

    // â”€â”€ Stars â”€â”€
    function initStars() {
        const container = document.getElementById('starsContainer');
        const frag = document.createDocumentFragment();
        for (let i = 0; i < 100; i++) {
            const s = document.createElement('div');
            const bright = Math.random() < 0.15;
            s.className = bright ? 'star star--bright' : 'star star--small';
            s.style.left = Math.random() * 100 + '%';
            s.style.top = Math.random() * 60 + '%';
            const size = bright ? (Math.random() * 2 + 1.5) : (Math.random() * 1.5 + 0.6);
            s.style.width = size + 'px';
            s.style.height = size + 'px';
            s.style.setProperty('--dur', (Math.random() * 4 + 2.5) + 's');
            s.style.animationDelay = (Math.random() * 6) + 's';
            frag.appendChild(s);
        }
        container.appendChild(frag);
    }

    // â”€â”€ Clouds â”€â”€
    function initClouds() {
        const container = document.getElementById('cloudsContainer');
        const frag = document.createDocumentFragment();
        [
            { w: 120, h: 36, top: 8  }, { w: 90,  h: 28, top: 15 },
            { w: 150, h: 42, top: 22 }, { w: 80,  h: 24, top: 5  },
            { w: 110, h: 32, top: 30 }, { w: 70,  h: 22, top: 12 },
            { w: 130, h: 38, top: 25 },
        ].forEach(cfg => {
            const c = document.createElement('div');
            c.className = 'cloud';
            c.style.width = cfg.w + 'px';
            c.style.height = cfg.h + 'px';
            c.style.top = cfg.top + '%';
            c.style.background = 'rgba(255, 255, 255, 0.7)';
            const dur = 50 + Math.random() * 60;
            c.style.setProperty('--cloud-dur', dur + 's');
            c.style.setProperty('--cloud-delay', (-dur * Math.random()) + 's');
            frag.appendChild(c);
        });
        container.appendChild(frag);
    }

    // â”€â”€ Fireflies â”€â”€
    function initFireflies() {
        const container = document.getElementById('firefliesContainer');
        const frag = document.createDocumentFragment();
        for (let i = 0; i < 18; i++) {
            const f = document.createElement('div');
            f.className = 'firefly';
            f.style.left = (10 + Math.random() * 80) + '%';
            f.style.top = (15 + Math.random() * 70) + '%';
            const r = () => (Math.random() * 120 - 60) + 'px';
            f.style.setProperty('--ff-dx1', r());
            f.style.setProperty('--ff-dy1', r());
            f.style.setProperty('--ff-dx2', r());
            f.style.setProperty('--ff-dy2', r());
            f.style.setProperty('--ff-dx3', r());
            f.style.setProperty('--ff-dy3', r());
            f.style.setProperty('--ff-dur', (8 + Math.random() * 12) + 's');
            f.style.setProperty('--ff-glow-dur', (2 + Math.random() * 4) + 's');
            f.style.setProperty('--ff-delay', (-Math.random() * 10) + 's');
            frag.appendChild(f);
        }
        container.appendChild(frag);
    }

    // â”€â”€ Butterfly Cursor â”€â”€
    let bfX = -100, bfY = -100, bfTargetX = -100, bfTargetY = -100;
    let bfAngle = 0, bfFlap = 0;
    butterflyEl.textContent = '\uD83E\uDD8B';

    document.addEventListener('mousemove', (e) => {
        bfTargetX = e.clientX;
        bfTargetY = e.clientY;
    });

    function animateButterfly() {
        bfX += (bfTargetX - bfX) * 0.06;
        bfY += (bfTargetY - bfY) * 0.06;
        bfFlap += 0.15;
        const wobble = Math.sin(bfFlap) * 8;
        const tilt = (bfTargetX - bfX) * 0.3;
        butterflyEl.style.transform =
            'translate(' + (bfX + 16) + 'px, ' + (bfY - 20 + wobble) + 'px) ' +
            'rotate(' + Math.max(-20, Math.min(20, tilt)) + 'deg) ' +
            'scaleX(' + (0.8 + Math.abs(Math.sin(bfFlap)) * 0.4) + ')';
        requestAnimationFrame(animateButterfly);
    }
    animateButterfly();

    // â”€â”€ Floating Petals â”€â”€
    function initPetals() {
        const container = document.getElementById('petalsContainer');
        const frag = document.createDocumentFragment();
        for (let i = 0; i < 12; i++) {
            const p = document.createElement('div');
            p.className = 'petal';
            p.textContent = PETAL_CHARS[Math.floor(Math.random() * PETAL_CHARS.length)];
            p.style.left = Math.random() * 100 + '%';
            p.style.fontSize = (Math.random() * 0.4 + 0.5) + 'rem';
            p.style.setProperty('--fall-dur', (Math.random() * 14 + 16) + 's');
            p.style.setProperty('--drift-mid', (Math.random() * 100 - 50) + 'px');
            p.style.setProperty('--drift-end', (Math.random() * 180 - 90) + 'px');
            p.style.setProperty('--delay', (Math.random() * 18) + 's');
            frag.appendChild(p);
        }
        container.appendChild(frag);
    }

    // â”€â”€ Click Ripple â”€â”€
    function spawnRipple(pageX, pageY) {
        const r = document.createElement('div');
        r.className = 'click-ripple';
        r.style.left = pageX + 'px';
        r.style.top = pageY + 'px';
        garden.appendChild(r);
        r.addEventListener('animationend', () => r.remove());
    }

    // â”€â”€ Sparkles â”€â”€
    function spawnSparkles(container, glowColor, count) {
        const ring = document.createElement('div');
        ring.className = 'sparkle-ring';
        container.appendChild(ring);
        const n = count || 8;
        for (let i = 0; i < n; i++) {
            const sp = document.createElement('span');
            sp.className = 'sparkle';
            sp.textContent = SPARKLE_CHARS[Math.floor(Math.random() * SPARKLE_CHARS.length)];
            const angle = (Math.PI * 2 * i) / n + (Math.random() * 0.4 - 0.2);
            const dist = 24 + Math.random() * 22;
            sp.style.setProperty('--tx', Math.cos(angle) * dist + 'px');
            sp.style.setProperty('--ty', Math.sin(angle) * dist + 'px');
            ring.appendChild(sp);
        }
        const bloomRing = document.createElement('div');
        bloomRing.className = 'bloom-ring';
        bloomRing.style.setProperty('--ring-color', glowColor + '55');
        container.appendChild(bloomRing);
        setTimeout(() => { ring.remove(); bloomRing.remove(); }, 1200);
    }

    // â”€â”€ Auto-expand garden â”€â”€
    function expandGarden(pageX, pageY) {
        const buffer = 80;
        if (pageY + buffer > garden.offsetHeight)
            garden.style.minHeight = (pageY + buffer) + 'px';
        if (pageX + buffer > garden.offsetWidth)
            garden.style.minWidth = (pageX + buffer) + 'px';
    }

    // â”€â”€ Milestone Toast â”€â”€
    function checkMilestone(count) {
        const msg = MILESTONES[count];
        if (!msg) return;
        const toast = document.createElement('div');
        toast.className = 'milestone-toast';
        toast.textContent = msg;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 4000);
    }

    // â”€â”€ Pick flower (with rare chance) â”€â”€
    function pickFlower() {
        if (Math.random() < RARE_FLOWER.chance) return RARE_FLOWER;
        return FLOWERS[Math.floor(Math.random() * FLOWERS.length)];
    }

    // â”€â”€ Water splash effect â”€â”€
    function spawnWaterSplash(container) {
        const drops = ['\uD83D\uDCA7', '\u2022', '\u2E31'];
        for (let i = 0; i < 6; i++) {
            const d = document.createElement('span');
            d.className = 'water-drop';
            d.textContent = drops[Math.floor(Math.random() * drops.length)];
            d.style.top = '30%';
            d.style.left = '50%';
            d.style.setProperty('--wx', (Math.random() * 30 - 15) + 'px');
            d.style.animationDelay = (Math.random() * 0.2) + 's';
            container.appendChild(d);
            setTimeout(() => d.remove(), 1100);
        }
        const ring = document.createElement('div');
        ring.className = 'water-ring';
        container.appendChild(ring);
        setTimeout(() => ring.remove(), 900);
    }

    // â”€â”€ Place a flower on the page â”€â”€
    function placeFlower(flower, pageX, pageY, bloomAtMs, fromSave, wiltAtMs) {
        const now = Date.now();
        const bloomSec = Math.max(0, (bloomAtMs - now) / 1000);
        const alreadyBloomed = bloomSec <= 0;

        expandGarden(pageX, pageY);
        if (!fromSave) spawnRipple(pageX, pageY);

        const container = document.createElement('div');
        container.className = 'flower-container';
        container.style.left = pageX + 'px';
        container.style.top = pageY + 'px';

        const el = document.createElement('span');
        const tip = document.createElement('div');
        tip.className = 'tooltip';

        // Find saved data entry for this flower (for updating wiltAt)
        const savedEntry = fromSave
            ? gardenData.flowers.find(f => f.x === pageX && f.y === pageY && f.bloomAt === bloomAtMs)
            : null;

        function startWiltTimer(wiltMs) {
            const msLeft = wiltMs - Date.now();
            if (msLeft <= 0) {
                wiltNow();
                return;
            }
            const timer = setTimeout(wiltNow, msLeft);
            activeTimers.push(timer);
        }

        function wiltNow() {
            if (!container.parentNode) return;
            container.classList.add('wilted');
            el.className = 'flower-el stage-wilted' + (fromSave ? ' from-save' : '');
            el.textContent = '\uD83E\uDD40';
            el.style.filter = '';
            el.style.animation = '';
            el.style.transform = '';
            tip.textContent = '\uD83D\uDCA7 water me';
        }

        function waterFlower() {
            if (!container.classList.contains('wilted')) return;
            container.classList.remove('wilted');
            spawnWaterSplash(container);

            el.className = 'flower-el stage-bloom' + (flower.rare ? ' rare-bloom' : '');
            el.textContent = flower.emoji;
            el.style.setProperty('--glow', flower.glow + (flower.rare ? '70' : '50'));
            tip.textContent = flower.name + (flower.rare ? ' \u2605' : '');

            spawnSparkles(container, flower.glow, flower.rare ? 14 : 8);

            setTimeout(() => {
                if (container.parentNode) el.classList.add('sway');
            }, flower.rare ? 1500 : 1150);

            const newWiltAt = Date.now() + (WILT_RANGE[0] + Math.random() * (WILT_RANGE[1] - WILT_RANGE[0])) * 1000;
            if (savedEntry) {
                savedEntry.wiltAt = newWiltAt;
                saveGarden(gardenData);
            }
            startWiltTimer(newWiltAt);
        }

        container.addEventListener('click', (ev) => {
            if (container.classList.contains('wilted')) {
                ev.stopPropagation();
                waterFlower();
            }
        });

        // Determine wilt time
        if (!wiltAtMs && !fromSave && alreadyBloomed) {
            wiltAtMs = Date.now() + (WILT_RANGE[0] + Math.random() * (WILT_RANGE[1] - WILT_RANGE[0])) * 1000;
        }

        const alreadyWilted = wiltAtMs && wiltAtMs <= now;

        if (alreadyWilted) {
            el.className = 'flower-el stage-wilted from-save';
            el.textContent = '\uD83E\uDD40';
            container.classList.add('wilted');
            tip.textContent = '\uD83D\uDCA7 water me';
        } else if (alreadyBloomed) {
            el.className = 'flower-el stage-bloom' + (flower.rare ? ' rare-bloom' : '') + ' sway';
            el.textContent = flower.emoji;
            el.style.setProperty('--glow', flower.glow + (flower.rare ? '70' : '50'));
            tip.textContent = flower.name + (flower.rare ? ' \u2605' : '');
            if (fromSave) {
                el.style.animation = 'none';
                el.style.opacity = '1';
                el.style.transform = 'none';
                el.style.filter = 'drop-shadow(0 0 ' + (flower.rare ? '18' : '12') + 'px ' + flower.glow + (flower.rare ? '70' : '50') + ')';
            }
            if (wiltAtMs) startWiltTimer(wiltAtMs);
        } else {
            el.className = 'flower-el stage-seed';
            el.textContent = '\uD83C\uDF31';
        }

        container.appendChild(el);
        container.appendChild(tip);
        garden.appendChild(container);

        let bloomed = alreadyBloomed || alreadyWilted;

        if (!bloomed) {
            const tipTimer = setInterval(() => {
                if (bloomed) { clearInterval(tipTimer); return; }
                const sec = Math.max(0, Math.ceil((bloomAtMs - Date.now()) / 1000));
                tip.textContent = sec > 0
                    ? 'Blooms in ' + formatTimeLeft(sec) + '\u2026'
                    : 'Almost there\u2026';
            }, 1000);

            const totalBloomMs = bloomAtMs - now;
            const sproutAt = totalBloomMs * 0.4;

            const sproutTimer = setTimeout(() => {
                if (!container.parentNode || bloomed) return;
                el.className = 'flower-el stage-sprout';
                el.textContent = '\uD83C\uDF3F';
            }, sproutAt);

            const bloomTimer = setTimeout(() => {
                if (!container.parentNode) return;
                bloomed = true;
                clearInterval(tipTimer);

                el.className = 'flower-el stage-bloom' + (flower.rare ? ' rare-bloom' : '');
                el.textContent = flower.emoji;
                el.style.setProperty('--glow', flower.glow + (flower.rare ? '70' : '50'));
                tip.textContent = flower.name + (flower.rare ? ' \u2605' : '');

                spawnSparkles(container, flower.glow, flower.rare ? 14 : 8);

                setTimeout(() => {
                    if (container.parentNode) el.classList.add('sway');
                }, flower.rare ? 1500 : 1150);

                const newWiltAt = Date.now() + (WILT_RANGE[0] + Math.random() * (WILT_RANGE[1] - WILT_RANGE[0])) * 1000;
                const entry = gardenData.flowers.find(f => f.x === pageX && f.y === pageY && f.bloomAt === bloomAtMs);
                if (entry) {
                    entry.wiltAt = newWiltAt;
                    saveGarden(gardenData);
                }
                startWiltTimer(newWiltAt);
            }, totalBloomMs);

            activeTimers.push(tipTimer, sproutTimer, bloomTimer);
        }
    }

    // â”€â”€ Restore saved flowers â”€â”€
    function restoreFlowers() {
        if (!gardenData.flowers || !gardenData.flowers.length) return;
        gardenData.flowers.forEach(f => {
            const flowerDef = f.rare
                ? RARE_FLOWER
                : FLOWERS.find(fl => fl.name === f.name) || FLOWERS[0];
            placeFlower(flowerDef, f.x, f.y, f.bloomAt, true, f.wiltAt || null);
        });
    }

    // â”€â”€ Plant Flower (click handler) â”€â”€
    garden.addEventListener('click', (e) => {
        if (e.target.closest('.flower-container')) return;

        const flower = pickFlower();
        const bloomSec = Math.floor(flower.range[0] + Math.random() * (flower.range[1] - flower.range[0]));
        const bloomAt = Date.now() + bloomSec * 1000;
        const pageX = e.pageX;
        const pageY = e.pageY;

        const wiltAt = bloomAt + (WILT_RANGE[0] + Math.random() * (WILT_RANGE[1] - WILT_RANGE[0])) * 1000;

        placeFlower(flower, pageX, pageY, bloomAt, false, wiltAt);

        flowerCount++;
        updateCounter();
        checkMilestone(flowerCount);

        gardenData.count = flowerCount;
        gardenData.flowers.push({
            name: flower.name,
            rare: !!flower.rare,
            x: pageX,
            y: pageY,
            bloomAt: bloomAt,
            wiltAt: wiltAt
        });
        saveGarden(gardenData);
    });

    // â”€â”€ Counter â”€â”€
    function updateCounter() {
        counterEl.textContent = flowerCount + ' flower' + (flowerCount !== 1 ? 's' : '') + ' planted';
    }

    // â”€â”€ Init â”€â”€
    initStars();
    initClouds();
    initFireflies();
    initPetals();
    restoreFlowers();
    updateCounter();
</script>
</body>
</html>
